extends layout

block content  
  .row
    br
    br
  .row
    .large-3.columns
      
    .large-6.columns.hide-for-small
      p Use your phone to type a message!
      #messagesDiv
    .large-3.columns.show-for-small.hide-for-medium.hide-for-large
      p Type your message to appear on the computer:
      input(type='text', id='nameInput', placeholder='Name')
      input(type='text', id='messageInput', placeholder='Message...')

  script.
    // Get a reference to the root of the chat data.
    var messagesRef = new Firebase('https://finalprojectcd.firebaseio.com/');

    // When the user presses enter on the message input, write the message to firebase.
    $('#messageInput').keypress(function (e) {
      if (e.keyCode == 13) {
        var name = $('#nameInput').val();
        var text = $('#messageInput').val();
        messagesRef.push({name:name, text:text});
        $('#messageInput').val('');
      }
    });

    // Add a callback that is triggered for each chat message.
    messagesRef.limit(10).on('child_added', function (snapshot) {
      var message = snapshot.val();
      $('<div/>').text(message.text).prepend($('<em/>')
        .text(message.name+': ')).preppendTo($('#messagesDiv'));
      $('#messagesDiv')[0].scrollTop = $('#messagesDiv')[0].scrollHeight;
    });